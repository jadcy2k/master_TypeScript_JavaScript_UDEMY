<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PROMESAS</title>
</head>
<body>
  <script>
    // PROMESAS
    // ####################################################################
    console.log("++++++++++++ PROMESAS ++++++++++++++");
    console.log("++ JS es un lenguaje ASÍNCRONO. Las promesas permiten controlar esas operaciones asíncronas.");

    // Simulamos la respuesta de una petición API:
    let arrayProductos = [
      {
        nombre: "Ordenador",
        marca: "Apple",
        precio: 1500
      },
      {
        nombre: "Tablet",
        marca: "Samsung",
        precio: 750
      },
      {
        nombre: "Smartphone",
        marca: "Motorola",
        precio: 475
      },
    ];
    
    // Acceder a los productos con PROMESAS:
    let getProductosPromise = () => {
      console.log("1) Esperando los datos...");
      return new Promise ( (resolve, reject) => {
        setTimeout ( () => {
          // NOTA: Para testear, se puede comentar y descomentar los "resolve" y "reject":

          //resolve(arrayProductos)}, 2000 ); //2 segundos.
          reject(Error("2) Ha ocurrido un error."))}, 2000 )
      });
    };

    // Ahora hay que reaccionar si existe un RESOLVE, lo hacemos con THEN.
    // Si existe un REJECT, haremos un CATCH del error.
    // También podemos usar FINALLY para ejecutar algo cuando se haya terminado la promesa:
    getProductosPromise()
      .then (items => {
        console.log("2) resultado llamada a promesa:", items);
      })
      .catch (error => console.log(error.message))
      .finally ( () => {
        console.log("3) Promesa finalizada.");
        console.log("--------------------------------------");    
      });

  </script>
  <h1>PROMESAS (parte 2)</h1>
  <h2>Ver el código fuente (dentro de "script" y la salida de cónsola.</h2>
  <a href="https://www.udemy.com/course/master-en-typescript-javascript-moderno-ecmascript-es12-apis-html5/learn/lecture/28201888">
    https://www.udemy.com/course/master-en-typescript-javascript-moderno-ecmascript-es12-apis-html5/learn/lecture/28201888
  </a>
  <h3>MÁS INFO:</h3>
  <a href="https://developer.mozilla.org/es/docs/Web/JavaScript/Guide/Using_promises"></a>
</body>
</html>